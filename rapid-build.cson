common:
	# build: server: false
	# build: client: false
	# browser: open: false, reload: false

	ports:
		server: 5000
		reload: 5001

	angular:
		moduleName: 'rapid-build'
		modules: ['ngclipboard', 'ui.codemirror']
		bootstrap: true
		templateCache:
			dev: true
			useAbsolutePaths: true

	spa:
		autoInject: ['ngCloakStyles']
		src:
			filePath: 'spa.html'

	dist:
		server:
			fileName: 'app.js'

	extra:
		copy:
			client: [
				'bare-bones.html'
				'node_modules/**'
			]
			server: [
				'data/**'
			]
		watch:
			client: [
				'bare-bones.html'
				'node_modules/@rapid-build-ui/'
			]
			server: [
				'data/**'
			]
		minify:
			client:
				css: [
					'node_modules/codemirror/lib/codemirror.css'
					'node_modules/codemirror-one-dark-theme/one-dark.css'
				]
				js: [
					'node_modules/codemirror/lib/codemirror.js'
					'node_modules/codemirror/mode/xml/xml.js'
					'node_modules/codemirror/mode/css/css.js'
					'node_modules/codemirror/mode/javascript/javascript.js'
					'node_modules/codemirror/mode/shell/shell.js'
					# 'node_modules/codemirror/mode/htmlmixed/htmlmixed.js' // if needed
					'node_modules/codemirror/addon/display/placeholder.js'
					# 'node_modules/angular-ui-codemirror/src/ui-codemirror.js' # causes js error
				]

	exclude:
		from:
			cacheBust: [
				'node_modules/**'
			]
			minFile:
				styles: [
					'styles/themes/**'
				]
			spaFile:
				scripts: [
					'scripts/es-modules/**'
				]

	minify:
		spa:
			file: false
		client:
			js:
				es6: true
		server:
			js:
				es6: true
			json:
				enable: false
		html:
			options:
				ignoreCustomFragments: [
					/\s<rb-icon|<\/rb-icon>\s/gi
					/\s<rb-button|<\/rb-button>\s/gi
					/\s<rb-popover|<\/rb-popover>\s/gi
					/<rba-code(\s*?.*?)*?rba-code>/gi
					/\s<rba-copy|<\/rba-copy>\s/gi
					/\s<rba-install|<\/rba-install>\s/gi
					/<textarea(\s*?.*?)*?\/textarea>/gi # for codemirror
				]

	order:
		scripts:
			first: [
				'node_modules/clipboard/dist/clipboard.min.js'
				'node_modules/ngclipboard/dist/ngclipboard.min.js'
				'node_modules/codemirror/lib/codemirror.js'
				'node_modules/codemirror/mode/xml/xml.js'
				'node_modules/codemirror/mode/css/css.js'
				'node_modules/codemirror/mode/javascript/javascript.js'
				'node_modules/codemirror/mode/shell/shell.js'
				# 'node_modules/codemirror/mode/htmlmixed/htmlmixed.js' // if needed
				'node_modules/codemirror/addon/display/placeholder.js'
				'node_modules/angular-ui-codemirror/src/ui-codemirror.js'
			]
		styles:
			first: [
				'styles/reset.css'
				'styles/grid.css'
				'node_modules/codemirror/lib/codemirror.css'
				'node_modules/codemirror-one-dark-theme/one-dark.css'
			]